<style>
  @font-face {
    font-family: octicons-link;
    src: url(data:font/woff;charset=utf-8;base64,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)
      format('woff');
  }
</style>
<script>
  const THEMES = ['Oncehub', 'Chatonce', 'Inviteonce', 'Scheduleonce'];
  const TAGID = 'theme-css';
  const IFRAMEID = 'storybook-preview-iframe';
  let switchCount = 0;
  let directory = window.location.host.indexOf('github') > 0 ? '/once-ui' : '';
  function onLoad() {
    setTheme(THEMES[0]);
    addThemeSelectElement();
  }

  function setTheme(theme) {
    switchCount++;
    let css = document.createElement('link');
    css.rel = 'stylesheet';
    css.id = TAGID + switchCount;
    css.href = getThemePath(theme);
    window.frames[IFRAMEID].contentDocument
      .getElementsByTagName('head')[0]
      .appendChild(css);
    setTimeout(() => {
      if (
        window.frames[IFRAMEID].contentDocument.getElementById(
          TAGID + (switchCount - 1)
        )
      ) {
        window.frames[IFRAMEID].contentDocument.getElementById(
          TAGID + (switchCount - 1)
        ).outerHTML = '';
      }
    });
  }

  function getThemePath(theme) {
    return directory + '/themes/' + theme.toLowerCase() + '.css';
  }

  function addThemeSelectElement() {
    const themeSelectBox = themeSelectBoxHtmlString();
    const themeSelectEle = createElementFromHTML(themeSelectBox);

    const headerElement = document.querySelectorAll('div.os-content > div')[1];
    headerElement.firstElementChild.outerHTML += themeSelectEle;
    // headerElement.insertAdjacentHTML('beforeend', themeSelectEle);
  }

  function themeSelectBoxHtmlString() {
    const themesOptionHTML = THEMES.reduce((acc, curr) => {
      return `${acc}<option value='${curr}'>${curr}</option>`;
    }, '');

    return `<span class="css-11fmq5u"></span>
            <div style="padding: 4px 0px 0px 0px;">
                  <select id="themeSelect" style="-webkit-appearance:none;-moz-appearance:none;appearance:none;border:0;box-sizing:inherit;display:block;margin:0;background:white;padding:.42em 1em;font-size:13px;position:relative;-webkit-transition:all 200ms ease-out;transition:all 200ms ease-out;color:#333333;box-shadow:rgba(0,0,0,.1) 0 0 0 1px inset;border-radius:4px;line-height:20px;-webkit-flex:1;-ms-flex:1;flex:1;height:32px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;padding-right:20px;-webkit-appearance:menulist;-moz-appearance:menulist;appearance:menulist;"
                  onchange="themeChange()">
                  ${themesOptionHTML}  
                  </select>
            </div>`;
  }

  function createElementFromHTML(htmlString) {
    var div = document.createElement('div');
    div.innerHTML = htmlString;

    // Change this to div.childNodes to support multiple top-level nodes
    return div.innerHTML;
  }

  function themeChange() {
    var theme = document.getElementById('themeSelect').value;
    setTheme(theme);
  }
  window.onload = function () {
    setTimeout(() => {
      onLoad();
    }, 2000);
  };
</script>
